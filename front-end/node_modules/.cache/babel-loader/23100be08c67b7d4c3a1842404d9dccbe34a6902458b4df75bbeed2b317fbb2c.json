{"ast":null,"code":"import _objectSpread from\"E:/Project/AssignmentSubmisssionApp/front-end/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"E:/Project/AssignmentSubmisssionApp/front-end/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"E:/Project/AssignmentSubmisssionApp/front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import dayjs from\"dayjs\";import React,{useEffect,useState}from\"react\";import{Button,Col,Row}from\"react-bootstrap\";import Comment from\"../Comment\";import ajax from\"../Services/fetchService\";import{useUser}from\"../UserProvider\";import{useInterval}from\"../util/useInterval\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentContainer=function CommentContainer(props){var assignmentId=props.assignmentId;var user=useUser();var emptyComment={id:null,text:\"\",assignmentId:assignmentId!=null?parseInt(assignmentId):null,user:user.jwt,createdDate:null};var _useState=useState(emptyComment),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];useInterval(function(){updateCommentTimeDisplay();},1000*5);function updateCommentTimeDisplay(){var commentsCopy=_toConsumableArray(comments);commentsCopy.forEach(function(comment){return comment.createdDate=dayjs(comment.createdDate);});formatComments(commentsCopy);}function handleEditComment(commentId){var i=comments.findIndex(function(comment){return comment.id===commentId;});var commentCopy={id:comments[i].id,text:comments[i].text,assignmentId:assignmentId!=null?parseInt(assignmentId):null,user:user.jwt,createdDate:comments[i].createdDate};setComment(commentCopy);}function handleDeleteComment(commentId){// TODO: send DELETE request to server\najax(\"/api/comments/\".concat(commentId),\"delete\",user.jwt).then(function(msg){var commentsCopy=_toConsumableArray(comments);var i=commentsCopy.findIndex(function(comment){return comment.id===commentId;});commentsCopy.splice(i,1);formatComments(commentsCopy);});}function formatComments(commentsCopy){commentsCopy.forEach(function(comment){if(typeof comment.createDate===\"string\"){comment.createDate=dayjs(comment.createDate);}});setComments(commentsCopy);}useEffect(function(){ajax(\"/api/comments?assignmentId=\".concat(assignmentId),\"get\",user.jwt,null).then(function(commentsData){formatComments(commentsData);});},[]);function updateComment(value){var commentCopy=_objectSpread({},comment);commentCopy.text=value;setComment(commentCopy);}function submitComment(){// if (\n//   typeof comment.createdDate === \"object\" &&\n//   comment.createdDate != null\n// ) {\n//   comment.createdDate = comment.createdDate.toDate();\n// }\nif(comment.id){ajax(\"/api/comments/\".concat(comment.id),\"put\",user.jwt,comment).then(function(d){var commentsCopy=_toConsumableArray(comments);var i=commentsCopy.findIndex(function(comment){return comment.id===d.id;});commentsCopy[i]=d;formatComments(commentsCopy);setComment(emptyComment);});}else{ajax(\"/api/comments\",\"post\",user.jwt,comment).then(function(d){var commentsCopy=_toConsumableArray(comments);commentsCopy.push(d);formatComments(commentsCopy);setComment(emptyComment);});}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mt-5\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Comments\"})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{lg:\"8\",md:\"10\",sm:\"12\",children:/*#__PURE__*/_jsx(\"textarea\",{style:{width:\"100%\",borderRadius:\"0.25em\"},onChange:function onChange(e){return updateComment(e.target.value);},value:comment.text})})}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return submitComment();},children:\"Post Comment\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-5\",children:comments.map(function(comment){return/*#__PURE__*/_jsx(Comment,{commentData:comment,emitDeleteComment:handleDeleteComment,emitEditComment:handleEditComment},comment.id);})})]});};export default CommentContainer;","map":{"version":3,"names":["dayjs","React","useEffect","useState","Button","Col","Row","Comment","ajax","useUser","useInterval","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","CommentContainer","props","assignmentId","user","emptyComment","id","text","parseInt","jwt","createdDate","_useState","_useState2","_slicedToArray","comment","setComment","_useState3","_useState4","comments","setComments","updateCommentTimeDisplay","commentsCopy","_toConsumableArray","forEach","formatComments","handleEditComment","commentId","i","findIndex","commentCopy","handleDeleteComment","concat","then","msg","splice","createDate","commentsData","updateComment","value","_objectSpread","submitComment","d","push","children","className","lg","md","sm","style","width","borderRadius","onChange","e","target","onClick","map","commentData","emitDeleteComment","emitEditComment"],"sources":["E:/Project/AssignmentSubmisssionApp/front-end/src/CommentContainer/index.js"],"sourcesContent":["import dayjs from \"dayjs\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Button, Col, Row } from \"react-bootstrap\";\r\nimport Comment from \"../Comment\";\r\nimport ajax from \"../Services/fetchService\";\r\nimport { useUser } from \"../UserProvider\";\r\nimport { useInterval } from \"../util/useInterval\";\r\n\r\nconst CommentContainer = (props) => {\r\n  const { assignmentId } = props;\r\n  const user = useUser();\r\n\r\n  const emptyComment = {\r\n    id: null,\r\n    text: \"\",\r\n    assignmentId: assignmentId != null ? parseInt(assignmentId) : null,\r\n    user: user.jwt,\r\n    createdDate: null,\r\n  };\r\n\r\n  const [comment, setComment] = useState(emptyComment);\r\n  const [comments, setComments] = useState([]);\r\n\r\n  useInterval(() => {\r\n    updateCommentTimeDisplay();\r\n  }, 1000 * 5);\r\n  function updateCommentTimeDisplay() {\r\n    const commentsCopy = [...comments];\r\n    commentsCopy.forEach(\r\n      (comment) => (comment.createdDate = dayjs(comment.createdDate))\r\n    );\r\n    formatComments(commentsCopy);\r\n  }\r\n\r\n  function handleEditComment(commentId) {\r\n    const i = comments.findIndex((comment) => comment.id === commentId);\r\n    const commentCopy = {\r\n      id: comments[i].id,\r\n      text: comments[i].text,\r\n      assignmentId: assignmentId != null ? parseInt(assignmentId) : null,\r\n      user: user.jwt,\r\n      createdDate: comments[i].createdDate,\r\n    };\r\n    setComment(commentCopy);\r\n  }\r\n\r\n  function handleDeleteComment(commentId) {\r\n    // TODO: send DELETE request to server\r\n    ajax(`/api/comments/${commentId}`, \"delete\", user.jwt).then((msg) => {\r\n      const commentsCopy = [...comments];\r\n      const i = commentsCopy.findIndex((comment) => comment.id === commentId);\r\n      commentsCopy.splice(i, 1);\r\n      formatComments(commentsCopy);\r\n    });\r\n  }\r\n  function formatComments(commentsCopy) {\r\n    commentsCopy.forEach((comment) => {\r\n      if (typeof comment.createDate === \"string\") {\r\n        comment.createDate = dayjs(comment.createDate);\r\n      }\r\n    });\r\n    setComments(commentsCopy);\r\n  }\r\n\r\n  useEffect(() => {\r\n    ajax(\r\n      `/api/comments?assignmentId=${assignmentId}`,\r\n      \"get\",\r\n      user.jwt,\r\n      null\r\n    ).then((commentsData) => {\r\n      formatComments(commentsData);\r\n    });\r\n  }, []);\r\n\r\n  function updateComment(value) {\r\n    const commentCopy = { ...comment };\r\n    commentCopy.text = value;\r\n    setComment(commentCopy);\r\n  }\r\n  function submitComment() {\r\n    // if (\r\n    //   typeof comment.createdDate === \"object\" &&\r\n    //   comment.createdDate != null\r\n    // ) {\r\n    //   comment.createdDate = comment.createdDate.toDate();\r\n    // }\r\n    if (comment.id) {\r\n      ajax(`/api/comments/${comment.id}`, \"put\", user.jwt, comment).then(\r\n        (d) => {\r\n          const commentsCopy = [...comments];\r\n          const i = commentsCopy.findIndex((comment) => comment.id === d.id);\r\n          commentsCopy[i] = d;\r\n          formatComments(commentsCopy);\r\n\r\n          setComment(emptyComment);\r\n        }\r\n      );\r\n    } else {\r\n      ajax(\"/api/comments\", \"post\", user.jwt, comment).then((d) => {\r\n        const commentsCopy = [...comments];\r\n        commentsCopy.push(d);\r\n        formatComments(commentsCopy);\r\n        setComment(emptyComment);\r\n      });\r\n    }\r\n  }\r\n  return (\r\n    <>\r\n      <div className=\"mt-5\">\r\n        <h4>Comments</h4>\r\n      </div>\r\n      <Row>\r\n        <Col lg=\"8\" md=\"10\" sm=\"12\">\r\n          <textarea\r\n            style={{ width: \"100%\", borderRadius: \"0.25em\" }}\r\n            onChange={(e) => updateComment(e.target.value)}\r\n            value={comment.text}\r\n          ></textarea>\r\n        </Col>\r\n      </Row>\r\n      <Button onClick={() => submitComment()}>Post Comment</Button>\r\n      <div className=\"mt-5\">\r\n        {comments.map((comment) => (\r\n          <Comment\r\n            key={comment.id}\r\n            commentData={comment}\r\n            emitDeleteComment={handleDeleteComment}\r\n            emitEditComment={handleEditComment}\r\n          />\r\n        ))}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CommentContainer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}